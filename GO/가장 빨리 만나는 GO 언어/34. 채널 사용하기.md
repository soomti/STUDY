# 34. 채널 사용하기

##### 채널

고루틴 끼리 데이터를 주고받고 실행 흐름을 제어하는 기능 

모든 타입을 채널로 사용할 수 있다. 

채널은 레퍼런스 타입이다.



##### make(chan 자료형)

채널을 사용하기전에, `make` 함수로 공간을 할당해야 한다

이렇게 생성하면 **동기 채널** 이 생성된다. 

고루틴과 채널을 사용하여 두 정수값을 더해보자

```go
package main

import "fmt"

func sum(a int, b int, c chan int) {
    c <- a + b // 채널에 a+b 합을 보냈따
}

func main() {
    c := make(chan int) // int 형 채널 설정 
    
    go sum(1, 2, c) // sum 을 고루틴으로 실행한 뒤 채널을 매개변수로 넘겨준다 
    
    n := <- c // 채널에서 값을 꺼낸 뒤 n 에 대입
    fmt.Println(n) //3
}
```



##### `:= ` 를 사용하지 않고 할당

```go
var c chan int // chan int 형 변수 선언
c = make(chan int)
```



채널을 매개변수로 받는 함수는 반드시 __go__ 키워드를 사용하여 고루틴으로 실행해야 한다.

```
go sum (1,2,c)
```



함수에서 채널을 매개변수로 받을 때는 다음과 같은 형식으로 사용한다 

##### 변수명 chan 자료형

```go
func sum(a int, b int, c chan int) {
    c <- a +b
}
```



##### <-

채널에 값을 보내는 기호

```
채널 <- 값
```

변수에 대입하지 않고 바로 사용 가능

```go
fmt.Println(<-c)
```

이때는 채널에서 값이 들어올 때까지 대기한다. 

채널에 값이 들어오면 대기를 끝내고 다음 코드를 실행한다. 

채널은 값을 주고받는 동시에 동기화 역할까지 수행한다. 





## 34.1 동기 채널

동기 채널의 특성을 알아보자.

```go
package main

import (
  "fmt"
  "time"
)

func main() {
    done := make(chan bool)
    count := 3
    
    go func() {
        done <- true
        fmt.Println(" 고루틴 : ", i)
        time.Sleeep(1* time.second) // 1초 대기
    }()
    
    for i := 0 ; i < count ; i ++ {
        <- done
        fmt.Println("메인 함수:",i  )
    }
}
```

